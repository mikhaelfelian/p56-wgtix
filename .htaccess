# /.htaccess di: htdocs/p56-wgtix
RewriteEngine On
RewriteBase /

# 1) Kalau file/dir beneran ada, langsung serve
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# 2) Tangani request ke /file/... -> arahkan ke /public/file/...
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^file/(.*)$ public/file/$1 [L]
RewriteRule ^assets/(.*)$ public/assets/$1 [L]

# 3) Sisanya route ke front controller di /public/index.php
RewriteRule ^(.*)$ public/index.php [QSA,L]

# ----------------------
# Security Headers
# ----------------------
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
    Header always set X-Frame-Options "SAMEORIGIN"
</IfModule>

# -----------------------------
# PHP settings (opsional)
# -----------------------------
<IfModule mod_php.c>
    php_value session.cookie_httponly 1
    php_value session.use_only_cookies 1
    php_value session.cookie_samesite "Lax"
</IfModule>

# ----------------------
# Enable Gzip compression
# ----------------------
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/json
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
</IfModule>

# ----------------------
# MIME Types
# (cukup via mod_mime agar tidak dobel)
# ----------------------
<IfModule mod_mime.c>
    AddType text/css .css
    AddType application/javascript .js
    AddType application/json .json
</IfModule>

# (Opsional) Paksa Content-Type utk ekstensi tertentu
# Catatan: bisa konflik dengan server/CDN. Pakai bila perlu saja.
<IfModule mod_headers.c>
    <FilesMatch "\.css$">
        Header set Content-Type "text/css; charset=UTF-8"
    </FilesMatch>
    <FilesMatch "\.js$">
        Header set Content-Type "application/javascript; charset=UTF-8"
    </FilesMatch>
</IfModule>

# ----------------------
# PHP Handler (sesuaikan dengan server Anda)
# ----------------------
AddHandler application/x-httpd-php82 .php
